#!/usr/bin/env bash
#
# Yet another fetch ...

initcolors() {
	# colors
	esc=""
	redf="${esc}[31m";
	greenf="${esc}[32m"
	yellowf="${esc}[33m"
	bluef="${esc}[34m";
	purplef="${esc}[35m"
	cyanf="${esc}[36m";
	reset="${esc}[0m";
}
initcolors

config=("date" "time" "kernel" "uptime" "weather" "disk")
weather_city="Pécs"
disk_path=("/dev/sda1")

time_prefix="${redf} ${reset}"
kernel_prefix="${greenf} ${reset}"
uptime_prefix="${yellowf} ${reset}"
date_prefix="${bluef} ${reset}"
weather_prefix="${purplef}摒${reset}"
disk_prefix="${cyanf} ${reset}"

for val in ${config[*]}; do
	case $val in
		time)
			time="$(date +"%H:%M %p")"
			argconf+=$time_prefix' '$time'\n'
			;;
		date)
			date="$(date +"%a %F")"
			argconf+=$date_prefix' '$date'\n'
			;;
		kernel)
			kern="$(uname -sr | sed 's/-.*//')"
			argconf+=$kernel_prefix' '$kern'\n'
			;;
		uptime)
			upt="$(uptime -p | sed 's/up //')"
			argconf+=$uptime_prefix' '$upt'\n'
			;;
		weather)
			weather="$(curl -s http://wttr.in/$weather_city?format=3 | awk '{print $3}' )"
			argconf+=$weather_prefix' '$weather'\n'
		;;
		disk)
			disk_total="$(df -h | grep ${disk_path} | awk '{print $2}')"
			disk_used="$(df -h | grep ${disk_path} | awk '{print $3}')"
			argconf+=$disk_prefix' '$disk_used'/'$disk_total'\n'
		;;
	esac
done

echo ""
echo -ne $argconf
echo ""
